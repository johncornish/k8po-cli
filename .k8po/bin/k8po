#!/usr/bin/env bash -e

K8PO_REPO_ROOT=~/workspace/k8po-cli
K8PO_ROOT=~/.k8po
cmd=$1

check_and_update

if [[ "${cmd}" == "test-wavefront-metrics" ]]; then
  ${K8PO_ROOT}/hack/test/test-wavefront-metrics.sh ${@:2}
fi

function check_and_update() {
  if [ ! -d "${K8PO_REPO_ROOT}" ]; then
    mkdir -p ~/workspace/
    pushd ~/workspace/
      git clone git@github.com:johncornish/k8po-cli.git
    popd

    install
  fi
}

function install() {
  pushd "${K8PO_REPO_ROOT}"
    ./install.sh
  popd
}
